YUI.add("inputex-colorpicker",function(f){var c=f.inputEx,e=f.Lang;var d=f.YUI2,a=d.util.Event,b=d.util.Dom;c.ColorPickerField=function(g){c.ColorPickerField.superclass.constructor.call(this,g)};f.extend(c.ColorPickerField,c.Field,{setOptions:function(g){c.ColorPickerField.superclass.setOptions.call(this,g);this.options.className=g.className?g.className:"inputEx-Field inputEx-ColorPickerField";this.options.colorPickerOptions=e.isUndefined(g.colorPickerOptions)?{}:g.colorPickerOptions;this.options.colorPickerOptions.showcontrols=e.isUndefined(this.options.colorPickerOptions.showcontrols)?true:this.options.colorPickerOptions.showcontrols;this.options.colorPickerOptions.images=e.isUndefined(this.options.colorPickerOptions.images)?{PICKER_THUMB:"../lib/yui/colorpicker/assets/picker_thumb.png",HUE_THUMB:"../lib/yui/colorpicker/assets/hue_thumb.png"}:this.options.colorPickerOptions.images},renderComponent:function(){this.el=c.cn("input",{type:"hidden",name:this.options.name||"",value:this.options.value||"#FFFFFF"});this.wrapEl=c.cn("div",{className:"inputEx-ColorPickerField-wrapper"});this.wrapEl.appendChild(this.el);this.menuElId=b.generateId();var i=new d.widget.Menu(this.menuElId);this.oColorPickerMenu=i;this.labelElId=b.generateId();var h=new d.widget.Button({type:"menu",className:"inputEx-ColorPicker-Button",label:'<em id="'+this.labelElId+"\" class='inputEx-ColorPicker-Label'>Current color is #FFFFFF.</em>",menu:i,container:this.wrapEl});var g=this;h.on("appendTo",function(){i.setBody(" ");i.body.id=b.generateId();b.addClass(i.body,g.options.colorPickerOptions.showcontrols?"inputEx-ColorPicker-Container":"inputEx-ColorPicker-Container-nocontrols");i.render(this.get("container"))});h.on("click",this.onButtonClickOnce,this,true);this.oButton=h;this.fieldContainer.appendChild(this.wrapEl)},onButtonClickOnce:function(g){this.oButton.unsubscribe("click",this.onButtonClickOnce,this);this.oColorPicker=new d.widget.ColorPicker(this.oColorPickerMenu.body.id,this.options.colorPickerOptions);if(this.options.value){this.oColorPicker.set("hex",this.options.value.substr(1))}this.oColorPicker.on("rgbChange",this.onRgbChange,this,true)},onRgbChange:function(j){var h="#"+this.oColorPicker.get("hex");this.oButton.set("value",h);var g=b.get(this.labelElId);b.setStyle(g,"backgroundColor",h);g.innerHTML="Current color is "+h;this.el.value=h;if(this.rgbChangeTimeout){clearTimeout(this.rgbChangeTimeout)}var i=this;this.rgbChangeTimeout=setTimeout(function(){i.onRgbChangeTimeout()},50)},onRgbChangeTimeout:function(){this.fireUpdatedEvt()},setValue:function(i,g){this.el.value=i;if(this.oButton){this.oButton.set("value",i);var h=b.get(this.labelElId);if(h){b.setStyle(h,"backgroundColor",i);h.innerHTML="Current color is "+i}else{a.onAvailable(this.labelElId,function(){b.setStyle(this,"backgroundColor",i);this.innerHTML="Current color is "+i})}}if(this.oColorPicker){this.oColorPicker.set("hex",i.substr(1))}c.ColorPickerField.superclass.setValue.call(this,i,g)},getValue:function(){return this.el.value}});c.registerType("colorpicker",c.ColorPickerField,[])},"3.0.0a",{requires:["inputex-field","yui2-colorpicker","yui2-container","yui2-menu","yui2-button"]});